{% load heroicons %}
{% load static %}
  <h2 class="text-2xl font-bold text-gray-800 mb-4 lg:ml-14">Dashboard</h2>
<div class="bg-gray-100 p-6 rounded-lg shadow-md w-full  mx-auto grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 lg:ml-14"  style="margin-top: 10px;">


  <div class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4    gap-4">
    <!-- Total Sales -->
    <div class="bg-green-200 text-black p-4   shadow-lg shadow-cyan-500/50 " style="    box-shadow: 4px 4px 0px 0px rgb(245, 253, 245);">
      <h3 class="text-lg font-semibold">Total Sales</h3>
      <p class="text-2xl font-bold mt-2">{{ total }}</p>
    </div>
    <!-- Total Views -->
    <div class="bg-green-200  text-black  p-4 shadow-lg shadow-cyan-500/50 " style="    box-shadow: 4px 4px 0px 0px rgb(241, 252, 241);" >
      <h3 class="text-lg font-semibold">Total Views</h3>
      <p class="text-2xl font-bold mt-2">{{ views }}</p>
    </div>
    <div class="bg-green-200 text-black p-4  shadow-lg shadow-cyan-500/50 " style="    box-shadow: 4px 4px 0px 0px rgb(245, 255, 245);">
      <h3 class="text-lg font-semibold">Total Bids</h3>
      <p class="text-2xl font-bold mt-2">{{ bid_count }}</p>

    </div>
    <div class="bg-green-200 text-black p-2  shadow-lg shadow-cyan-500/50  p-2" style=" padding-right:100px;   box-shadow: 4px 4px 0px 0px rgb(255, 255, 255);">
      <h3 class="text-lg font-semibold">Total Earned</h3>
      <p class="text-2xl font-bold mt-2">{{ total_earned }}</p>
  </div>
  </div>

</div>


<div class="overflow-x-auto lg:ml-14" >

<caption class="text-2xl font-bold text-center lg:ml-10" >Sales</caption>
  <table class="table" >
    <thead >
      <tr>
        <th>Buyer Name</th>
        <th>Product Name</th>
        <th>Quantity Bought</th>
        <th>Total Earned</th>
        <th>Order ID</th>
        <th>Phone No</th>
        <th>Buyer Address</th>
        <th>Payment Method</th>
        <th>Status</th>

      </tr>
    </thead>
    <tbody>
      {% for name in sales %}
      <tr  onclick="document.getElementById('id01{{ name.id }}').style.display='block'" class="cursor-pointer">
        <td>{{ name.buyer_info.name }}</td>
        <td> {{ name.product_name }}</td>
        <td>{{ name.quantity }}</td>
        <td>{{ name.total_earned }}</td>
        <td>{{ name.order_id}}</td>

        <td>{{ name.buyer_info.phone }}</td>

        <td> {{ name.buyer_info.address }}</td>
        <td> {{ name.buyer_info.method }}</td>
        <td>
          {% if name.status == "pending" %}
      <a class="text-yellow-500" href="#" onclick="document.getElementById('id01{{ name.id }}').style.display='block'" >{{ name.status }}</a>
        {% elif name.status == "completed" %}
         <a class="text-green-500" href="#"  onclick="document.getElementById('id01{{ name.id }}').style.display='block'">{{ name.status }}</a>
        {% elif name.status == "  Out for Delivery" %}
        <a class="text-blue-500" href="#"  onclick="document.getElementById('id01{{ name.id }}').style.display='block'">{{ name.status }}</a>
        {% elif name.status == "cancelled" %}
       <a class="text-red-500" href="#"  onclick="document.getElementById('id01{{ name.id }}').style.display='block'">{{ name.status }}</a>
        {% else %}
        <a class="text-gray-500" href="#"  onclick="document.getElementById('id01{{ name.id }}').style.display='block'">{{ name.status }}</a>
          {% endif %}
        </td>



      </tr>

      <!-- Modal -->

      {% endfor %}
    </tbody>
  </table>

</div>

{% for name in sales %}


      <div id="id01{{ name.id }}" class="fixed inset-0 bg-[#cccccc] bg-opacity-50 flex items-center justify-center hidden z-10 ">
        <div class="bg-white rounded-lg shadow-lg p-6 w-[90%] mt-54 lg:w-1/3 lg:ml-94  lg:mt-34">
          <div class="flex justify-between items-center">
            <h2 class="text-xl font-bold">Do you want to update this item</h2>
            <button onclick="document.getElementById('id01{{ name.id }}').style.display='none'" class="text-gray-500 hover:text-gray-700">&times;</button>
          </div>
            <p class="mt-2 text-base"> {{ name.buyer_info.name }}  </p>
            <p class="mt-2 text-base">{{ name.product_name }}, {{ name.quantity }} items </p>
            <p class="mt-2 text-base">you will earn {{ name.total_earned }}</p>
            <form method="post" action="{% url 'update_status' id=name.id %}" class="mt-4">
              {% csrf_token %}
              <fieldset class="fieldset">
              <legend class="fieldset-legend">Update Status</legend>
                <select class="select" id="status" name="status">
              <option value="pending" {% if name.status == "pending" %}selected{% endif %}>Pending</option>
              <option value="out for delivery" {% if name.status == "out for delivery" %}selected{% endif %}>Out for Delivery</option>
              <option value="completed" {% if name.status == "completed" %}selected{% endif %}>Completed</option>
              <option value="cancelled" {% if name.status == "cancelled" %}selected{% endif %}>Cancelled</option>
              </select>
              <span class="label">Update the delivery status </span>
                </fieldset>
              <button type="submit" class="btn btn-success mt-2"> Submit</button>
             </form>
           <div class="mt-6 flex justify-end space-x-4">
            <button onclick="document.getElementById('id01{{ name.id }}').style.display='none'" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>

          </div>
        </div>
      </div>
{% endfor %}




 <caption class="text-2xl font-bold text-center mb-4" style="margin-right:90%">Bids</caption>

<div  class="overflow-x-auto">
  <table class="table">
    <thead >
      <tr>
        <th>Bidder Name</th>
        <th>Product Name</th>
        <th>Bid Price</th>
        <th>Bidder Email Address</th>
        <th>Bidder Message</th>
        <th>Bidder Address</th>
        <th>Bid Date</th>
        <th>Status</th>

      </tr>
    </thead>
    <tbody>
      {% for name in bids %}
      <tr >
        <td>{{ name.user.first_name }} {{name.user.last_name}}</td>
        <td> {{ name.name }}</td>
        <td>â‚¦ {{ name.bid_price }}</td>
        <td>{{ name.email }}</td>
        <td>{{ name.message}}</td>

        <td>{{ name.address }}</td>

        <td> {{ name.bid_time }}</td>
        <td> {{ name.status }}</td>



      </tr>

      <!-- Modal -->

      {% endfor %}
    </tbody>
  </table>

</div>
<div>


    <img src="data:image/png;base64,{{ data }}" alt="Chart"/>
  </div>
<style>
  #sales{
      background-color: #38c500;
  }
</style>